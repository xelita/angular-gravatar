var gravatarModule=angular.module("gravatarModule",[]);gravatarModule.constant("gravatarConstants",{apiVersion:"1.0.0",urls:{http:"http://www.gravatar.com/avatar",https:"https://secure.gravatar.com/avatar"},images:{notfound:"404",mysteryman:"mm",identicon:"identicon",monster:"monsterid",wavatar:"wavatar",retro:"retro",blank:"blank"},ratings:{g:"g",pg:"pg",r:"r",x:"x"}});gravatarModule.factory("gravatarService",["$rootScope","$log","$http","gravatarConstants",function(e,t,n,r){return{apiVersion:function(){t.debug("IN gravatarService.apiVersion.");return r.apiVersion},emailHash:function(e){t.debug("IN gravatarService.emailHash.");return md5(e.trim().toLowerCase())},getImageUrlFromEmail:function(e,n){t.debug("IN gravatarService.getImageFromEmail.");return this.getImageUrlFromEmailHash(this.emailHash(e),n)},getImageUrlFromEmailHash:function(e,n){t.debug("IN gravatarService.getImageUrlFromEmailHash.");var i=r.urls.http+"/"+e;if(n){t.debug("Gravatar configuration: "+angular.toJson(n));if(n.ssl===true){i=r.urls.https+"/"+e}if(n.ext){i+="."+n.ext}i+="?";if(n.size){i+="s="+n.size+"&"}if(n.defaultImage){i+="d="+encodeURIComponent(n.defaultImage)+"&"}if(n.forceDefaultImage===true){i+="f=y&"}if(n.rating){i+="r="+n.rating+"&"}}t.debug("Gravatar url is: "+i);return i}}}]);gravatarModule.directive("gravatarImage",function(e,t){return{priority:0,restrict:"E",scope:{email:"@",emailHash:"@",ssl:"@",ext:"@",size:"@",defaultImage:"@",forceDefaultImage:"@",rating:"@"},template:"<img/>",replace:true,link:function(n,r,i){var s=function(){e.debug("IN gravatarImage.gravatarInitFunction.");var i=n.emailHash?n.emailHash:t.emailHash(n.email);e.debug("email hash is: "+i);var s={};if(n.ssl==="true"){s.ssl=true}if(n.ext){s.ext=n.ext}if(n.size){s.size=n.size}if(n.defaultImage){s.defaultImage=n.defaultImage}if(n.forceDefaultImage==="true"){s.forceDefaultImage=true}if(n.rating){s.rating=n.rating}e.debug("Gravatar configuration: "+angular.toJson(s));var o=t.getImageUrlFromEmailHash(i,s);r.attr("src",o)};n.$watch("email",function(){s()});n.$watch("emailHash",function(){s()});n.$watch("ssl",function(){s()});n.$watch("ext",function(){s()});n.$watch("size",function(){s()});n.$watch("defaultImage",function(){s()});n.$watch("forceDefaultImage",function(){s()});n.$watch("rating",function(){s()})}}})